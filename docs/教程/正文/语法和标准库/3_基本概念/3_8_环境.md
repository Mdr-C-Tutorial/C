# 环境

## 1. 翻译环境与执行环境

C 标准把程序生命周期分为翻译环境和执行环境。翻译环境负责把源代码处理为可执行映像，执行环境负责真正运行程序。很多“编译通过但运行异常”的问题，本质是把这两层混在一起：编译阶段只能检查语法与约束，运行阶段才会触发输入输出、内存访问和并发调度等行为。

## 2. 宿主实现与独立实现

宿主实现 (Hosted Implementation) 通常运行在操作系统之上，`main` 是标准入口，标准库可用范围完整。独立实现 (Freestanding Implementation) 常见于内核、固件与启动代码，标准库只保证最小子集，程序入口也未必是 `main`。写可移植代码时，先判断目标属于哪种环境，再决定可依赖的接口。

## 3. 一个最小判断示例

```c
#include <stdio.h>

int main(void) {
#ifdef __STDC_HOSTED__
    printf("__STDC_HOSTED__ = %d\n", __STDC_HOSTED__);
#endif
    return 0;
}
```

当输出为 `1` 时，表示按宿主环境处理；为 `0` 时，表示独立环境。这个宏不能替代完整平台文档，但可以作为源码中的清晰分支条件。

## 4. 工程建议

凡是涉及文件系统、进程控制、线程或本地化的能力，都应在文档中明确环境前提。若某接口只在宿主环境成立，就不要把它表述成“通用 C 能力”；若目标是独立环境，就优先选择无隐式依赖的最小接口集。
